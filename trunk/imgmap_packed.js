
function imgmap(_1){this.version="2.0beta6";this.buildDate="2008/10/30 12:24";this.buildNumber="87";this.config={};this.is_drawing=0;this.strings=[];this.memory=[];this.areas=[];this.logStore=[];this.currentid=0;this.draggedId=null;this.selectedId=null;this.nextShape="rect";this.viewmode=0;this.loadedScripts=[];this.isLoaded=false;this.cntReloads=0;this.mapname="";this.mapid="";this.waterMark="<!-- Created by Online Image Map Editor (http://www.maschek.hu/imagemap/index) -->";this.DM_RECTANGLE_DRAW=1;this.DM_RECTANGLE_MOVE=11;this.DM_RECTANGLE_RESIZE_TOP=12;this.DM_RECTANGLE_RESIZE_RIGHT=13;this.DM_RECTANGLE_RESIZE_BOTTOM=14;this.DM_RECTANGLE_RESIZE_LEFT=15;this.DM_SQUARE_DRAW=2;this.DM_SQUARE_MOVE=21;this.DM_SQUARE_RESIZE_TOP=22;this.DM_SQUARE_RESIZE_RIGHT=23;this.DM_SQUARE_RESIZE_BOTTOM=24;this.DM_SQUARE_RESIZE_LEFT=25;this.DM_POLYGON_DRAW=3;this.DM_POLYGON_LASTDRAW=30;this.DM_POLYGON_MOVE=31;this.config.mode="editor";this.config.baseroot="";this.config.lang="";this.config.defaultLang="en";this.config.loglevel=0;this.config.custom_callbacks={};this.event_types=["onModeChanged","onClipboard","onHtmlChanged","onAddArea","onRemoveArea","onDrawArea","onResizeArea","onRelaxArea","onFocusArea","onBlurArea","onMoveArea","onSelectRow","onLoadImage","onSetMap","onGetMap","onSelectArea","onStatusMessage","onAreaChanged"];this.config.CL_DRAW_BOX="#dd2400";this.config.CL_DRAW_SHAPE="#d00";this.config.CL_DRAW_BG="#fff";this.config.CL_NORM_BOX="#dd2400";this.config.CL_NORM_SHAPE="#d00";this.config.CL_NORM_BG="#fff";this.config.CL_HIGHLIGHT_BOX="#dd2400";this.config.CL_HIGHLIGHT_SHAPE="#d00";this.config.CL_HIGHLIGHT_BG="#fff";this.config.CL_KNOB="#ffeeee";this.config.bounding_box=true;this.config.label="%n";this.config.label_class="imgmap_label";this.config.label_style="font: bold 10px Arial";this.config.hint="#%n %h";this.config.draw_opacity="35";this.config.norm_opacity="50";this.config.highlight_opacity="70";this.config.cursor_default="crosshair";var ua=navigator.userAgent;this.isMSIE=(navigator.appName=="Microsoft Internet Explorer");this.isMSIE5=this.isMSIE&&(ua.indexOf("MSIE 5")!=-1);this.isMSIE5_0=this.isMSIE&&(ua.indexOf("MSIE 5.0")!=-1);this.isMSIE7=this.isMSIE&&(ua.indexOf("MSIE 7")!=-1);this.isGecko=ua.indexOf("Gecko")!=-1;this.isSafari=ua.indexOf("Safari")!=-1;this.isOpera=(typeof window.opera!="undefined");this.addEvent(document,"keydown",this.doc_keydown.bind(this));this.addEvent(document,"keyup",this.doc_keyup.bind(this));this.addEvent(document,"mousedown",this.doc_mousedown.bind(this));if(_1){this.setup(_1);}}
imgmap.prototype.assignOID=function(_3){try{if(typeof _3=="undefined"){this.log("Undefined object passed to assignOID.");return null;}else{if(typeof _3=="object"){return _3;}else{if(typeof _3=="string"){return document.getElementById(_3);}}}}
catch(err){this.log("Error in assignOID",1);}
return null;};imgmap.prototype.setup=function(_4){for(var i in _4){this.config[i]=_4[i];}
if(_4){this.pic_container=this.assignOID(_4.pic_container);this.disableSelection(this.pic_container);}
if(!this.config.baseroot){var _6=document.getElementsByTagName("base");var _7="";for(i=0;i<_6.length;i++){if(_6[i].href){_7=_6[i].href;if(_7.charAt(_7.length-1)!="/"){_7+="/";}
break;}}
var _8=document.getElementsByTagName("script");for(i=0;i<_8.length;i++){if(_8[i].src&&_8[i].src.match(/imgmap\w*\.js(\?.*?)?$/)){var _9=_8[i].src;_9=_9.substring(0,_9.lastIndexOf("/")+1);if(_7&&_9.indexOf("://")==-1){this.config.baseroot=_7+_9;}else{this.config.baseroot=_9;}
break;}}}
if(this.isMSIE&&typeof window.CanvasRenderingContext2D=="undefined"&&typeof G_vmlCanvasManager=="undefined"){this.loadScript(this.config.baseroot+"excanvas.js");}
if(!this.config.lang){this.config.lang=this.detectLanguage();}
this.loadScript(this.config.baseroot+"lang_"+this.config.lang+".js");var _a,j;for(i in this.config.custom_callbacks){_a=false;for(j=0;j<this.event_types.length;j++){if(i==this.event_types[j]){_a=true;break;}}
if(!_a){this.log("Unknown custom callback: "+i,1);}}
this.addEvent(window,"load",this.onLoad.bind(this));return true;};imgmap.prototype.retryDelayed=function(fn,_d,_e){if(typeof fn.tries=="undefined"){fn.tries=0;}
if(fn.tries++<_e){window.setTimeout(function(){fn.apply(this);},_d);}};imgmap.prototype.onLoad=function(e){if(this.isLoaded){return true;}
var _10=this;if(typeof imgmapStrings=="undefined"){if(this.cntReloads++<5){window.setTimeout(function(){_10.onLoad(e);},1200);this.log("Delaying onload (language "+this.config.lang+" not loaded, try: "+this.cntReloads+")");return false;}else{if(this.config.lang!=this.config.defaultLang&&this.config.defaultLang!="en"){this.log("Falling back to default language: "+this.config.defaultLang);this.cntReloads=0;this.config.lang=this.config.defaultLang;this.loadScript(this.config.baseroot+"lang_"+this.config.lang+".js");window.setTimeout(function(){_10.onLoad(e);},1200);return false;}else{if(this.config.lang!="en"){this.log("Falling back to english language");this.cntReloads=0;this.config.lang="en";this.loadScript(this.config.baseroot+"lang_"+this.config.lang+".js");window.setTimeout(function(){_10.onLoad(e);},1200);return false;}}}}
try{this.loadStrings(imgmapStrings);}
catch(err){this.log("Unable to load language strings",1);}
if(this.isMSIE){if(typeof window.CanvasRenderingContext2D=="undefined"&&typeof G_vmlCanvasManager=="undefined"){this.log(this.strings.ERR_EXCANVAS_LOAD,2);}}
if(this.config.mode=="highlighter"){imgmap_spawnObjects(this.config);}
this.isLoaded=true;return true;};imgmap.prototype.addEvent=function(obj,evt,_13){if(obj.attachEvent){return obj.attachEvent("on"+evt,_13);}else{if(obj.addEventListener){obj.addEventListener(evt,_13,false);return true;}else{obj["on"+evt]=_13;}}};imgmap.prototype.removeEvent=function(obj,evt,_16){if(obj.detachEvent){return obj.detachEvent("on"+evt,_16);}else{if(obj.removeEventListener){obj.removeEventListener(evt,_16,false);return true;}else{obj["on"+evt]=null;}}};imgmap.prototype.addLoadEvent=function(obj,_18){if(obj.attachEvent){return obj.attachEvent("onreadystatechange",_18);}else{if(obj.addEventListener){obj.addEventListener("load",_18,false);return true;}else{obj.onload=_18;}}};imgmap.prototype.loadScript=function(url){if(url===""){return false;}
if(this.loadedScripts[url]==1){return true;}
this.log("Loading script: "+url);try{var _1a=document.getElementsByTagName("head")[0];var _1b=document.createElement("SCRIPT");_1b.setAttribute("language","javascript");_1b.setAttribute("type","text/javascript");_1b.setAttribute("src",url);_1a.appendChild(_1b);this.addLoadEvent(_1b,this.script_load.bind(this));}
catch(err){this.log("Error loading script: "+url);}
return true;};imgmap.prototype.script_load=function(e){var obj=(this.isMSIE)?window.event.srcElement:e.currentTarget;var url=obj.src;var _1f=false;if(typeof obj.readyState!="undefined"){if(obj.readyState=="complete"){_1f=true;}}else{_1f=true;}
if(_1f){this.loadedScripts[url]=1;this.log("Loaded script: "+url);return true;}};imgmap.prototype.loadStrings=function(obj){for(var key in obj){this.strings[key]=obj[key];}};imgmap.prototype.loadImage=function(img,_23,_24){this.removeAllAreas();this.fireEvent("onHtmlChanged","");if(!this._getLastArea()){if(this.config.mode!="editor2"){this.addNewArea();}}
if(typeof img=="string"){if(typeof this.pic=="undefined"){this.pic=document.createElement("IMG");this.pic_container.appendChild(this.pic);this.addEvent(this.pic,"mousedown",this.img_mousedown.bind(this));this.addEvent(this.pic,"mouseup",this.img_mouseup.bind(this));this.addEvent(this.pic,"mousemove",this.img_mousemove.bind(this));this.pic.style.cursor=this.config.cursor_default;}
this.log("Loading image: "+img,0);var q="?";if(img.indexOf("?")>-1){q="&";}
this.pic.src=img+q+(new Date().getTime());if(_23&&_23>0){this.pic.setAttribute("width",_23);}
if(_24&&_24>0){this.pic.setAttribute("height",_24);}
this.fireEvent("onLoadImage",this.pic);}else{if(typeof img=="object"){var src=img.src;if(src===""&&img.getAttribute("mce_src")!==""){src=img.getAttribute("mce_src");}else{if(src===""&&img.getAttribute("_fcksavedurl")!==""){src=img.getAttribute("_fcksavedurl");}}
if(!_23){_23=img.clientWidth;}
if(!_24){_24=img.clientHeight;}
this.loadImage(src,_23,_24);}}};imgmap.prototype.useImage=function(img){this.removeAllAreas();if(!this._getLastArea()){if(this.config.mode!="editor2"){this.addNewArea();}}
img=this.assignOID(img);if(typeof img=="object"){this.pic=img;this.addEvent(this.pic,"mousedown",this.img_mousedown.bind(this));this.addEvent(this.pic,"mouseup",this.img_mouseup.bind(this));this.addEvent(this.pic,"mousemove",this.img_mousemove.bind(this));this.pic.style.cursor=this.config.cursor_default;this.pic_container=this.pic.parentNode;this.fireEvent("onLoadImage",this.pic);}};imgmap.prototype.statusMessage=function(str){this.fireEvent("onStatusMessage",str);};imgmap.prototype.log=function(obj,_2a){if(_2a===""||typeof _2a=="undefined"){_2a=0;}
if(this.config.loglevel!=-1&&_2a>=this.config.loglevel){this.logStore.push({level:_2a,obj:obj});}
if(typeof console=="object"){console.log(obj);}else{if(this.isOpera){opera.postError(_2a+": "+obj);}else{if(typeof air=="object"){if(typeof air.Introspector=="object"){air.Introspector.Console.log(obj);}else{air.trace(obj);}}else{if(_2a>1){var msg="";for(var i=0;i<this.logStore.length;i++){msg+=this.logStore[i].level+": "+this.logStore[i].obj+"\n";}
alert(msg);}else{window.defaultStatus=(_2a+": "+obj);}}}}};imgmap.prototype.getMapHTML=function(){var _2d="<map id=\""+this.getMapId()+"\" name=\""+this.getMapName()+"\">"+this.getMapInnerHTML()+this.waterMark+"</map>";this.fireEvent("onGetMap",_2d);return _2d;};imgmap.prototype.getMapInnerHTML=function(){var _2e="";for(var i=0;i<this.areas.length;i++){if(this.areas[i]){if(this.areas[i].shape&&this.areas[i].shape!="undefined"){_2e+="<area shape=\""+this.areas[i].shape+"\""+" alt=\""+this.areas[i].aalt+"\""+" title=\""+this.areas[i].atitle+"\""+" coords=\""+this.areas[i].lastInput+"\""+" href=\""+this.areas[i].ahref+"\""+" target=\""+this.areas[i].atarget+"\" />";}}}
return _2e;};imgmap.prototype.getMapName=function(){if(this.mapname===""){if(this.mapid!==""){return this.mapid;}
var now=new Date();this.mapname="imgmap"+now.getFullYear()+(now.getMonth()+1)+now.getDate()+now.getHours()+now.getMinutes()+now.getSeconds();}
return this.mapname;};imgmap.prototype.getMapId=function(){if(this.mapid===""){this.mapid=this.getMapName();}
return this.mapid;};imgmap.prototype._normCoords=function(_31,_32,_33){var i;var sx;var sy;var gx;var gy;var _39;_31=_31.trim();if(_31===""){return"";}
var _3a=_31;_31=_31.replace(/(\d)(\D)+(\d)/g,"$1,$3");_31=_31.replace(/,(\D|0)+(\d)/g,",$2");_31=_31.replace(/(\d)(\D)+,/g,"$1,");_31=_31.replace(/^(\D|0)+(\d)/g,"$2");var _3b=_31.split(",");if(_32=="rect"){if(_33=="fromcircle"){var r=_3b[2];_3b[0]=_3b[0]-r;_3b[1]=_3b[1]-r;_3b[2]=parseInt(_3b[0],10)+2*r;_3b[3]=parseInt(_3b[1],10)+2*r;}else{if(_33=="frompoly"){sx=parseInt(_3b[0],10);gx=parseInt(_3b[0],10);sy=parseInt(_3b[1],10);gy=parseInt(_3b[1],10);for(i=0;i<_3b.length;i++){if(i%2===0&&parseInt(_3b[i],10)<sx){sx=parseInt(_3b[i],10);}
if(i%2===1&&parseInt(_3b[i],10)<sy){sy=parseInt(_3b[i],10);}
if(i%2===0&&parseInt(_3b[i],10)>gx){gx=parseInt(_3b[i],10);}
if(i%2===1&&parseInt(_3b[i],10)>gy){gy=parseInt(_3b[i],10);}}
_3b[0]=sx;_3b[1]=sy;_3b[2]=gx;_3b[3]=gy;}}
if(!(parseInt(_3b[1],10)>0)){_3b[1]=_3b[0];}
if(!(parseInt(_3b[2],10)>0)){_3b[2]=parseInt(_3b[0],10)+10;}
if(!(parseInt(_3b[3],10)>0)){_3b[3]=parseInt(_3b[1],10)+10;}
if(parseInt(_3b[0],10)>parseInt(_3b[2],10)){_39=_3b[0];_3b[0]=_3b[2];_3b[2]=_39;}
if(parseInt(_3b[1],10)>parseInt(_3b[3],10)){_39=_3b[1];_3b[1]=_3b[3];_3b[3]=_39;}
_31=_3b[0]+","+_3b[1]+","+_3b[2]+","+_3b[3];}else{if(_32=="circle"){if(_33=="fromrect"){sx=parseInt(_3b[0],10);gx=parseInt(_3b[2],10);sy=parseInt(_3b[1],10);gy=parseInt(_3b[3],10);_3b[2]=(gx-sx<gy-sy)?gx-sx:gy-sy;_3b[2]=Math.floor(_3b[2]/2);_3b[0]=sx+_3b[2];_3b[1]=sy+_3b[2];}else{if(_33=="frompoly"){sx=parseInt(_3b[0],10);gx=parseInt(_3b[0],10);sy=parseInt(_3b[1],10);gy=parseInt(_3b[1],10);for(i=0;i<_3b.length;i++){if(i%2===0&&parseInt(_3b[i],10)<sx){sx=parseInt(_3b[i],10);}
if(i%2===1&&parseInt(_3b[i],10)<sy){sy=parseInt(_3b[i],10);}
if(i%2===0&&parseInt(_3b[i],10)>gx){gx=parseInt(_3b[i],10);}
if(i%2===1&&parseInt(_3b[i],10)>gy){gy=parseInt(_3b[i],10);}}
_3b[2]=(gx-sx<gy-sy)?gx-sx:gy-sy;_3b[2]=Math.floor(_3b[2]/2);_3b[0]=sx+_3b[2];_3b[1]=sy+_3b[2];}}
if(!(parseInt(_3b[1],10)>0)){_3b[1]=_3b[0];}
if(!(parseInt(_3b[2],10)>0)){_3b[2]=10;}
_31=_3b[0]+","+_3b[1]+","+_3b[2];}else{if(_32=="poly"){if(_33=="fromrect"){_3b[4]=_3b[2];_3b[5]=_3b[3];_3b[2]=_3b[0];_3b[6]=_3b[4];_3b[7]=_3b[1];}else{if(_33=="fromcircle"){var _3d=parseInt(_3b[0],10);var _3e=parseInt(_3b[1],10);var _3f=parseInt(_3b[2],10);var j=0;_3b[j++]=_3d+_3f;_3b[j++]=_3e;var _41=60;for(i=0;i<=_41;i++){var _42=i/_41;var _43=Math.cos(_42*2*Math.PI);var _44=Math.sin(_42*2*Math.PI);var _45=_3d+_43*_3f;var _46=_3e+_44*_3f;_3b[j++]=Math.round(_45);_3b[j++]=Math.round(_46);}}}
_31="";for(i=0;i<_3b.length;i++){_31+=_3b[i]+",";}
_31=_31.substring(0,_31.length-1);}}}
if(_33=="preserve"&&_3a!=_31){return _3a;}
return _31;};imgmap.prototype.setMapHTML=function(map){if(this.viewmode===1){return;}
this.fireEvent("onSetMap",map);this.removeAllAreas();var _48;if(typeof map=="string"){var _49=document.createElement("DIV");_49.innerHTML=map;_48=_49.firstChild;}else{if(typeof map=="object"){_48=map;}}
if(!_48||_48.nodeName.toLowerCase()!=="map"){return false;}
this.mapname=_48.name;this.mapid=_48.id;var _4a=_48.getElementsByTagName("area");var _4b,_4c,_4d,alt,_4f,_50;for(var i=0;i<_4a.length;i++){_4b=_4c=_4d=alt=_4f=_50="";id=this.addNewArea();if(_4a[i].getAttribute("shape",2)){_4b=_4a[i].getAttribute("shape",2);}else{_4b="rect";}
this.initArea(id,_4b);if(_4a[i].getAttribute("coords",2)){_4c=this._normCoords(_4a[i].getAttribute("coords",2),_4b);this.areas[id].lastInput=_4c;}
_4d=_4a[i].getAttribute("href",2);var _52=_4a[i].getAttribute("_fcksavedurl");if(_52){_4d=_52;}
if(_4d){this.areas[id].ahref=_4d;}
alt=_4a[i].getAttribute("alt");if(alt){this.areas[id].aalt=alt;}
_4f=_4a[i].getAttribute("title");if(!_4f){_4f=alt;}
if(_4f){this.areas[id].atitle=_4f;}
_50=_4a[i].getAttribute("target");if(_50){_50=_50.toLowerCase();}
this.areas[id].atarget=_50;this._recalculate(id,_4c);this.relaxArea(id);var obj={};obj[id]={};obj[id].shape=_4b;obj[id].coords=_4c;obj[id].href=_4d;obj[id].alt=alt;obj[id].title=_4f;obj[id].target=_50;this.fireEvent("onAreaChanged",obj);}
this.fireEvent("onHtmlChanged",this.getMapHTML());};imgmap.prototype.togglePreview=function(){var i;if(!this.pic){return false;}
if(!this.preview){this.preview=document.createElement("DIV");this.preview.style.display="none";this.pic.parentNode.appendChild(this.preview);}
if(this.viewmode===0){for(i=0;i<this.areas.length;i++){if(this.areas[i]){this.areas[i].style.display="none";if(this.areas[i].label){this.areas[i].label.style.display="none";}}}
this.preview.innerHTML=this.getMapHTML();this.pic.setAttribute("border","0",0);this.pic.setAttribute("usemap","#"+this.mapname,0);this.pic.style.cursor="auto";this.viewmode=1;this.statusMessage(this.strings.PREVIEW_MODE);}else{for(i=0;i<this.areas.length;i++){if(this.areas[i]){this.areas[i].style.display="";if(this.areas[i].label&&this.config.label){this.areas[i].label.style.display="";}}}
this.preview.innerHTML="";this.pic.style.cursor=this.config.cursor_default;this.pic.removeAttribute("usemap",0);this.viewmode=0;this.statusMessage(this.strings.DESIGN_MODE);this.is_drawing=0;}
this.fireEvent("onModeChanged",this.viewmode);return this.viewmode;};imgmap.prototype.addNewArea=function(){if(this.viewmode===1){return;}
var _55=this._getLastArea();var id=(_55)?_55.aid+1:0;this.areas[id]=document.createElement("DIV");this.areas[id].id=this.mapname+"area"+id;this.areas[id].aid=id;this.areas[id].shape="undefined";this.currentid=id;this.fireEvent("onAddArea",id);return id;};imgmap.prototype.initArea=function(id,_58){if(!this.areas[id]){return false;}
if(this.areas[id].parentNode){this.areas[id].parentNode.removeChild(this.areas[id]);}
if(this.areas[id].label){this.areas[id].label.parentNode.removeChild(this.areas[id].label);}
this.areas[id]=null;this.areas[id]=document.createElement("CANVAS");this.pic.parentNode.appendChild(this.areas[id]);this.pic.parentNode.style.position="relative";if(typeof G_vmlCanvasManager!="undefined"){this.areas[id]=G_vmlCanvasManager.initElement(this.areas[id]);}
this.areas[id].id=this.mapname+"area"+id;this.areas[id].aid=id;this.areas[id].shape=_58;this.areas[id].ahref="";this.areas[id].atitle="";this.areas[id].aalt="";this.areas[id].atarget="";this.areas[id].style.position="absolute";this.areas[id].style.top=this.pic.offsetTop+"px";this.areas[id].style.left=this.pic.offsetLeft+"px";this._setopacity(this.areas[id],this.config.CL_DRAW_BG,this.config.draw_opacity);this.areas[id].onmousedown=this.area_mousedown.bind(this);this.areas[id].onmouseup=this.area_mouseup.bind(this);this.areas[id].onmousemove=this.area_mousemove.bind(this);this.areas[id].onmouseover=this.area_mouseover.bind(this);this.areas[id].onmouseout=this.area_mouseout.bind(this);this.memory[id]={};this.memory[id].downx=0;this.memory[id].downy=0;this.memory[id].left=0;this.memory[id].top=0;this.memory[id].width=0;this.memory[id].height=0;this.memory[id].xpoints=[];this.memory[id].ypoints=[];this.areas[id].label=document.createElement("DIV");this.pic.parentNode.appendChild(this.areas[id].label);this.areas[id].label.className=this.config.label_class;this.assignCSS(this.areas[id].label,this.config.label_style);this.areas[id].label.style.position="absolute";};imgmap.prototype.relaxArea=function(id){if(!this.areas[id]){return;}
this.fireEvent("onRelaxArea",id);if(this.areas[id].shape=="rect"){this.areas[id].style.borderWidth="1px";this.areas[id].style.borderStyle="solid";this.areas[id].style.borderColor=this.config.CL_NORM_SHAPE;}else{if(this.areas[id].shape=="circle"||this.areas[id].shape=="poly"){if(this.config.bounding_box){this.areas[id].style.borderWidth="1px";this.areas[id].style.borderStyle="solid";this.areas[id].style.borderColor=this.config.CL_NORM_BOX;}else{this.areas[id].style.border="";}}}
this._setopacity(this.areas[id],this.config.CL_NORM_BG,this.config.norm_opacity);};imgmap.prototype.relaxAllAreas=function(){for(var i=0;i<this.areas.length;i++){if(this.areas[i]){this.relaxArea(i);}}};imgmap.prototype._setopacity=function(_5b,_5c,pct){if(_5c){_5b.style.backgroundColor=_5c;}
if(pct&&typeof pct=="string"&&pct.match(/^\d*\-\d+$/)){var _5e=pct.split("-");if(typeof _5e[0]!="undefined"){_5e[0]=parseInt(_5e[0],10);this._setopacity(_5b,_5c,_5e[0]);}
if(typeof _5e[1]!="undefined"){_5e[1]=parseInt(_5e[1],10);var _5f=this._getopacity(_5b);var _60=this;var _61=Math.round(_5e[1]-_5f);if(_61>5){window.setTimeout(function(){_60._setopacity(_5b,null,"-"+_5e[1]);},20);pct=1*_5f+5;}else{if(_61<-3){window.setTimeout(function(){_60._setopacity(_5b,null,"-"+_5e[1]);},20);pct=1*_5f-3;}else{pct=_5e[1];}}}}
if(!isNaN(pct)){pct=Math.round(parseInt(pct,10));_5b.style.opacity=pct/101;_5b.style.filter="alpha(opacity="+pct+")";}};imgmap.prototype._getopacity=function(_62){if(_62.style.opacity<=1){return _62.style.opacity*100;}
if(_62.style.filter){return parseInt(_62.style.filter.replace(/alpha\(opacity\=([^\)]*)\)/ig,"$1"),10);}
return 100;};imgmap.prototype.removeArea=function(id,_64){if(this.viewmode===1){return;}
if(id===null||typeof id=="undefined"){return;}
try{this.areas[id].label.parentNode.removeChild(this.areas[id].label);this.areas[id].parentNode.removeChild(this.areas[id]);this.areas[id].label.className=null;this.areas[id].label=null;this.areas[id].onmouseover=null;this.areas[id].onmouseout=null;this.areas[id].onmouseup=null;this.areas[id].onmousedown=null;this.areas[id].onmousemove=null;}
catch(err){}
this.areas[id]=null;this.fireEvent("onRemoveArea",id);if(!_64){this.fireEvent("onHtmlChanged",this.getMapHTML());}};imgmap.prototype.removeAllAreas=function(){for(var i=0;i<this.areas.length;i++){if(this.areas[i]){this.removeArea(i,true);}}
this.fireEvent("onHtmlChanged",this.getMapHTML());};imgmap.prototype._putlabel=function(id){if(this.viewmode===1){return;}
if(!this.areas[id].label){return;}
try{if(!this.config.label){this.areas[id].label.innerHTML="";this.areas[id].label.style.display="none";}else{this.areas[id].label.style.display="";var _67=this.config.label;_67=_67.replace(/%n/g,String(id));_67=_67.replace(/%c/g,String(this.areas[id].lastInput));_67=_67.replace(/%h/g,String(this.areas[id].ahref));_67=_67.replace(/%a/g,String(this.areas[id].aalt));_67=_67.replace(/%t/g,String(this.areas[id].atitle));this.areas[id].label.innerHTML=_67;}
this.areas[id].label.style.top=this.areas[id].style.top;this.areas[id].label.style.left=this.areas[id].style.left;}
catch(err){this.log("Error putting label",1);}};imgmap.prototype._puthint=function(id){try{if(!this.config.hint){this.areas[id].title="";this.areas[id].alt="";}else{var _69=this.config.hint;_69=_69.replace(/%n/g,String(id));_69=_69.replace(/%c/g,String(this.areas[id].lastInput));_69=_69.replace(/%h/g,String(this.areas[id].ahref));_69=_69.replace(/%a/g,String(this.areas[id].aalt));_69=_69.replace(/%t/g,String(this.areas[id].atitle));this.areas[id].title=_69;this.areas[id].alt=_69;}}
catch(err){this.log("Error putting hint",1);}};imgmap.prototype._repaintAll=function(){for(var i=0;i<this.areas.length;i++){if(this.areas[i]){this._repaint(this.areas[i],this.config.CL_NORM_SHAPE);}}};imgmap.prototype._repaint=function(_6b,_6c,x,y){var ctx;var _70;var _71;if(_6b.shape=="circle"){_70=parseInt(_6b.style.width,10);var _72=Math.floor(_70/2)-1;ctx=_6b.getContext("2d");ctx.clearRect(0,0,_70,_70);ctx.beginPath();ctx.strokeStyle=_6c;ctx.arc(_72,_72,_72,0,Math.PI*2,0);ctx.stroke();ctx.closePath();ctx.strokeStyle=this.config.CL_KNOB;ctx.strokeRect(_72,_72,1,1);this._putlabel(_6b.aid);this._puthint(_6b.aid);}else{if(_6b.shape=="rect"){this._putlabel(_6b.aid);this._puthint(_6b.aid);}else{if(_6b.shape=="poly"){_70=parseInt(_6b.style.width,10);_71=parseInt(_6b.style.height,10);var _73=parseInt(_6b.style.left,10);var top=parseInt(_6b.style.top,10);if(_6b.xpoints){ctx=_6b.getContext("2d");ctx.clearRect(0,0,_70,_71);ctx.beginPath();ctx.strokeStyle=_6c;ctx.moveTo(_6b.xpoints[0]-_73,_6b.ypoints[0]-top);for(var i=1;i<_6b.xpoints.length;i++){ctx.lineTo(_6b.xpoints[i]-_73,_6b.ypoints[i]-top);}
if(this.is_drawing==this.DM_POLYGON_DRAW||this.is_drawing==this.DM_POLYGON_LASTDRAW){ctx.lineTo(x-_73-5,y-top-5);}
ctx.lineTo(_6b.xpoints[0]-_73,_6b.ypoints[0]-top);ctx.stroke();ctx.closePath();}
this._putlabel(_6b.aid);this._puthint(_6b.aid);}}}};imgmap.prototype._updatecoords=function(id){var _77=parseInt(this.areas[id].style.left,10);var top=parseInt(this.areas[id].style.top,10);var _79=parseInt(this.areas[id].style.height,10);var _7a=parseInt(this.areas[id].style.width,10);var _7b="";if(this.areas[id].shape=="rect"){_7b=_77+","+top+","+(_77+_7a)+","+(top+_79);this.areas[id].lastInput=_7b;}else{if(this.areas[id].shape=="circle"){var _7c=Math.floor(_7a/2)-1;_7b=(_77+_7c)+","+(top+_7c)+","+_7c;this.areas[id].lastInput=_7b;}else{if(this.areas[id].shape=="poly"){_7b="";if(this.areas[id].xpoints){for(var i=0;i<this.areas[id].xpoints.length;i++){_7b+=this.areas[id].xpoints[i]+","+this.areas[id].ypoints[i]+",";}
_7b=_7b.substring(0,_7b.length-1);}
this.areas[id].lastInput=_7b;}}}
var obj={};obj[id]={};obj[id].coords=_7b;this.fireEvent("onAreaChanged",obj);this.fireEvent("onHtmlChanged",this.getMapHTML());};imgmap.prototype._recalculate=function(id,_80){try{if(_80){_80=this._normCoords(_80,this.areas[id].shape,"preserve");}else{_80=this.areas[id].lastInput||"";}
var _81=_80.split(",");if(this.areas[id].shape=="rect"){if(_81.length!=4||parseInt(_81[0],10)>parseInt(_81[2],10)||parseInt(_81[1],10)>parseInt(_81[3],10)){throw"invalid coords";}
this.areas[id].style.left=this.pic.offsetLeft+parseInt(_81[0],10)+"px";this.areas[id].style.top=this.pic.offsetTop+parseInt(_81[1],10)+"px";this.setAreaSize(id,(_81[2]-_81[0]),(_81[3]-_81[1]));this._repaint(this.areas[id],this.config.CL_NORM_SHAPE);}else{if(this.areas[id].shape=="circle"){if(_81.length!=3||parseInt(_81[2],10)<0){throw"invalid coords";}
var _82=2*(1*_81[2]+1);this.setAreaSize(id,_82,_82);this.areas[id].style.left=this.pic.offsetLeft+parseInt(_81[0],10)-_82/2+"px";this.areas[id].style.top=this.pic.offsetTop+parseInt(_81[1],10)-_82/2+"px";this._repaint(this.areas[id],this.config.CL_NORM_SHAPE);}else{if(this.areas[id].shape=="poly"){if(_81.length<2){throw"invalid coords";}
this.areas[id].xpoints=[];this.areas[id].ypoints=[];for(var i=0;i<_81.length;i+=2){this.areas[id].xpoints[this.areas[id].xpoints.length]=this.pic.offsetLeft+parseInt(_81[i],10);this.areas[id].ypoints[this.areas[id].ypoints.length]=this.pic.offsetTop+parseInt(_81[i+1],10);this._polygongrow(this.areas[id],_81[i],_81[i+1]);}
this._polygonshrink(this.areas[id]);}}}}
catch(err){var msg=(err.message)?err.message:"error calculating coordinates";this.log(msg,1);this.statusMessage(this.strings.ERR_INVALID_COORDS);if(this.areas[id].lastInput&&input){input.value=this.areas[id].lastInput;}
this._repaint(this.areas[id],this.config.CL_NORM_SHAPE);return;}
this.areas[id].lastInput=_80;};imgmap.prototype._polygongrow=function(_85,_86,_87){var _88=_86-parseInt(_85.style.left,10);var _89=_87-parseInt(_85.style.top,10);var pad=0;var _8b=0;if(_86<parseInt(_85.style.left,10)){_85.style.left=(_86-pad)+"px";this.setAreaSize(_85.aid,parseInt(_85.style.width,10)+Math.abs(_88)+_8b,null);}else{if(_86>parseInt(_85.style.left,10)+parseInt(_85.style.width,10)){this.setAreaSize(_85.aid,_86-parseInt(_85.style.left,10)+_8b,null);}}
if(_87<parseInt(_85.style.top,10)){_85.style.top=(_87-pad)+"px";this.setAreaSize(_85.aid,null,parseInt(_85.style.height,10)+Math.abs(_89)+_8b);}else{if(_87>parseInt(_85.style.top,10)+parseInt(_85.style.height,10)){this.setAreaSize(_85.aid,null,_87-parseInt(_85.style.top,10)+_8b);}}};imgmap.prototype._polygonshrink=function(_8c){_8c.style.left=(_8c.xpoints[0])+"px";_8c.style.top=(_8c.ypoints[0])+"px";this.setAreaSize(_8c.aid,0,0);for(var i=0;i<_8c.xpoints.length;i++){this._polygongrow(_8c,_8c.xpoints[i],_8c.ypoints[i]);}
this._repaint(_8c,this.config.CL_NORM_SHAPE);};imgmap.prototype.img_mousemove=function(e){var x;var y;var _91;var _92;var _93;if(this.viewmode===1){return;}
var pos=this._getPos(this.pic);x=(this.isMSIE)?(window.event.x-this.pic.offsetLeft):(e.pageX-pos.x);y=(this.isMSIE)?(window.event.y-this.pic.offsetTop):(e.pageY-pos.y);x=x+this.pic_container.scrollLeft;y=y+this.pic_container.scrollTop;if(x<0||y<0||x>this.pic.width||y>this.pic.height){return;}
if(this.memory[this.currentid]){var top=this.memory[this.currentid].top;var _96=this.memory[this.currentid].left;var _97=this.memory[this.currentid].height;var _98=this.memory[this.currentid].width;}
if(this.isSafari){if(e.shiftKey){if(this.is_drawing==this.DM_RECTANGLE_DRAW){this.is_drawing=this.DM_SQUARE_DRAW;this.statusMessage(this.strings.SQUARE2_DRAW);}}else{if(this.is_drawing==this.DM_SQUARE_DRAW&&this.areas[this.currentid].shape=="rect"){this.is_drawing=this.DM_RECTANGLE_DRAW;this.statusMessage(this.strings.RECTANGLE_DRAW);}}}
if(this.is_drawing==this.DM_RECTANGLE_DRAW){this.fireEvent("onDrawArea",this.currentid);_91=x-this.memory[this.currentid].downx;_92=y-this.memory[this.currentid].downy;this.setAreaSize(this.currentid,Math.abs(_91),Math.abs(_92));if(_91<0){this.areas[this.currentid].style.left=(x+1)+"px";}
if(_92<0){this.areas[this.currentid].style.top=(y+1)+"px";}}else{if(this.is_drawing==this.DM_SQUARE_DRAW){this.fireEvent("onDrawArea",this.currentid);_91=x-this.memory[this.currentid].downx;_92=y-this.memory[this.currentid].downy;if(Math.abs(_91)<Math.abs(_92)){_93=Math.abs(parseInt(_91,10));}else{_93=Math.abs(parseInt(_92,10));}
this.setAreaSize(this.currentid,_93,_93);if(_91<0){this.areas[this.currentid].style.left=(this.memory[this.currentid].downx+_93*-1)+"px";}
if(_92<0){this.areas[this.currentid].style.top=(this.memory[this.currentid].downy+_93*-1+1)+"px";}}else{if(this.is_drawing==this.DM_POLYGON_DRAW){this.fireEvent("onDrawArea",this.currentid);this._polygongrow(this.areas[this.currentid],x,y);}else{if(this.is_drawing==this.DM_RECTANGLE_MOVE||this.is_drawing==this.DM_SQUARE_MOVE){this.fireEvent("onMoveArea",this.currentid);x=x-this.memory[this.currentid].rdownx;y=y-this.memory[this.currentid].rdowny;if(x+_98>this.pic.width||y+_97>this.pic.height){return;}
if(x<0||y<0){return;}
this.areas[this.currentid].style.left=x+1+"px";this.areas[this.currentid].style.top=y+1+"px";}else{if(this.is_drawing==this.DM_POLYGON_MOVE){this.fireEvent("onMoveArea",this.currentid);x=x-this.memory[this.currentid].rdownx;y=y-this.memory[this.currentid].rdowny;if(x+_98>this.pic.width||y+_97>this.pic.height){return;}
if(x<0||y<0){return;}
_91=x-_96;_92=y-top;if(this.areas[this.currentid].xpoints){for(var i=0;i<this.areas[this.currentid].xpoints.length;i++){this.areas[this.currentid].xpoints[i]=this.memory[this.currentid].xpoints[i]+_91;this.areas[this.currentid].ypoints[i]=this.memory[this.currentid].ypoints[i]+_92;}}
this.areas[this.currentid].style.left=x+"px";this.areas[this.currentid].style.top=y+"px";}else{if(this.is_drawing==this.DM_SQUARE_RESIZE_LEFT){this.fireEvent("onResizeArea",this.currentid);_93=x-_96;if((_98+(-1*_93))>0){this.areas[this.currentid].style.left=x+1+"px";this.areas[this.currentid].style.top=(top+(_93/2))+"px";this.setAreaSize(this.currentid,parseInt(_98+(-1*_93),10),parseInt(_97+(-1*_93),10));}else{this.memory[this.currentid].width=0;this.memory[this.currentid].height=0;this.memory[this.currentid].left=x;this.memory[this.currentid].top=y;this.is_drawing=this.DM_SQUARE_RESIZE_RIGHT;}}else{if(this.is_drawing==this.DM_SQUARE_RESIZE_RIGHT){this.fireEvent("onResizeArea",this.currentid);_93=x-_96-_98;if((_98+(_93))-1>0){this.areas[this.currentid].style.top=(top+(-1*_93/2))+"px";this.setAreaSize(this.currentid,(_98+(_93))-1,(_97+(_93)));}else{this.memory[this.currentid].width=0;this.memory[this.currentid].height=0;this.memory[this.currentid].left=x;this.memory[this.currentid].top=y;this.is_drawing=this.DM_SQUARE_RESIZE_LEFT;}}else{if(this.is_drawing==this.DM_SQUARE_RESIZE_TOP){this.fireEvent("onResizeArea",this.currentid);_93=y-top;if((_98+(-1*_93))>0){this.areas[this.currentid].style.top=y+1+"px";this.areas[this.currentid].style.left=(_96+(_93/2))+"px";this.setAreaSize(this.currentid,(_98+(-1*_93)),(_97+(-1*_93)));}else{this.memory[this.currentid].width=0;this.memory[this.currentid].height=0;this.memory[this.currentid].left=x;this.memory[this.currentid].top=y;this.is_drawing=this.DM_SQUARE_RESIZE_BOTTOM;}}else{if(this.is_drawing==this.DM_SQUARE_RESIZE_BOTTOM){this.fireEvent("onResizeArea",this.currentid);_93=y-top-_97;if((_98+(_93))-1>0){this.areas[this.currentid].style.left=(_96+(-1*_93/2))+"px";this.setAreaSize(this.currentid,(_98+(_93))-1,(_97+(_93))-1);}else{this.memory[this.currentid].width=0;this.memory[this.currentid].height=0;this.memory[this.currentid].left=x;this.memory[this.currentid].top=y;this.is_drawing=this.DM_SQUARE_RESIZE_TOP;}}else{if(this.is_drawing==this.DM_RECTANGLE_RESIZE_LEFT){this.fireEvent("onResizeArea",this.currentid);_91=x-_96;if(_98+(-1*_91)>0){this.areas[this.currentid].style.left=x+1+"px";this.setAreaSize(this.currentid,_98+(-1*_91),null);}else{this.memory[this.currentid].width=0;this.memory[this.currentid].left=x;this.is_drawing=this.DM_RECTANGLE_RESIZE_RIGHT;}}else{if(this.is_drawing==this.DM_RECTANGLE_RESIZE_RIGHT){this.fireEvent("onResizeArea",this.currentid);_91=x-_96-_98;if((_98+(_91))-1>0){this.setAreaSize(this.currentid,(_98+(_91))-1,null);}else{this.memory[this.currentid].width=0;this.memory[this.currentid].left=x;this.is_drawing=this.DM_RECTANGLE_RESIZE_LEFT;}}else{if(this.is_drawing==this.DM_RECTANGLE_RESIZE_TOP){this.fireEvent("onResizeArea",this.currentid);_92=y-top;if((_97+(-1*_92))>0){this.areas[this.currentid].style.top=y+1+"px";this.setAreaSize(this.currentid,null,(_97+(-1*_92)));}else{this.memory[this.currentid].height=0;this.memory[this.currentid].top=y;this.is_drawing=this.DM_RECTANGLE_RESIZE_BOTTOM;}}else{if(this.is_drawing==this.DM_RECTANGLE_RESIZE_BOTTOM){this.fireEvent("onResizeArea",this.currentid);_92=y-top-_97;if((_97+(_92))-1>0){this.setAreaSize(this.currentid,null,(_97+(_92))-1);}else{this.memory[this.currentid].height=0;this.memory[this.currentid].top=y;this.is_drawing=this.DM_RECTANGLE_RESIZE_TOP;}}}}}}}}}}}}}}
if(this.is_drawing){this._repaint(this.areas[this.currentid],this.config.CL_DRAW_SHAPE,x,y);this._updatecoords(this.currentid);}};imgmap.prototype.img_mouseup=function(e){if(this.viewmode===1){return;}
var pos=this._getPos(this.pic);var x=(this.isMSIE)?(window.event.x-this.pic.offsetLeft):(e.pageX-pos.x);var y=(this.isMSIE)?(window.event.y-this.pic.offsetTop):(e.pageY-pos.y);x=x+this.pic_container.scrollLeft;y=y+this.pic_container.scrollTop;if(this.is_drawing!=this.DM_RECTANGLE_DRAW&&this.is_drawing!=this.DM_SQUARE_DRAW&&this.is_drawing!=this.DM_POLYGON_DRAW&&this.is_drawing!=this.DM_POLYGON_LASTDRAW){this.draggedId=null;this.is_drawing=0;this.statusMessage(this.strings.READY);this.relaxArea(this.currentid);if(this.areas[this.currentid]==this._getLastArea()){return;}
this.memory[this.currentid].downx=x;this.memory[this.currentid].downy=y;}};imgmap.prototype.img_mousedown=function(e){if(this.viewmode===1){return;}
if(!this.areas[this.currentid]&&this.config.mode!="editor2"){return;}
var pos=this._getPos(this.pic);var x=(this.isMSIE)?(window.event.x-this.pic.offsetLeft):(e.pageX-pos.x);var y=(this.isMSIE)?(window.event.y-this.pic.offsetTop):(e.pageY-pos.y);x=x+this.pic_container.scrollLeft;y=y+this.pic_container.scrollTop;if(!e){e=window.event;}
if(e.shiftKey){if(this.is_drawing==this.DM_POLYGON_DRAW){this.is_drawing=this.DM_POLYGON_LASTDRAW;}}
if(this.is_drawing==this.DM_POLYGON_DRAW){this.areas[this.currentid].xpoints[this.areas[this.currentid].xpoints.length]=x-5;this.areas[this.currentid].ypoints[this.areas[this.currentid].ypoints.length]=y-5;this.memory[this.currentid].downx=x;this.memory[this.currentid].downy=y;return;}else{if(this.is_drawing&&this.is_drawing!=this.DM_POLYGON_DRAW){if(this.is_drawing==this.DM_POLYGON_LASTDRAW){this.areas[this.currentid].xpoints[this.areas[this.currentid].xpoints.length]=x-5;this.areas[this.currentid].ypoints[this.areas[this.currentid].ypoints.length]=y-5;this._updatecoords(this.currentid);this.is_drawing=0;this._polygonshrink(this.areas[this.currentid]);}
this.is_drawing=0;this.statusMessage(this.strings.READY);this.relaxArea(this.currentid);if(this.areas[this.currentid]==this._getLastArea()){if(this.config.mode!="editor2"){this.addNewArea();}
return;}
return;}}
if(this.config.mode=="editor2"){if(!this.nextShape){return;}
this.addNewArea();this.initArea(this.currentid,this.nextShape);}else{if(this.areas[this.currentid].shape=="undefined"||this.areas[this.currentid].shape=="poly"){var _a2=this.nextShape;if(!_a2){_a2="rect";}
this.initArea(this.currentid,_a2);}}
if(this.areas[this.currentid].shape=="poly"){this.is_drawing=this.DM_POLYGON_DRAW;this.statusMessage(this.strings.POLYGON_DRAW);this.areas[this.currentid].style.left=x+"px";this.areas[this.currentid].style.top=y+"px";if(this.config.bounding_box){this.areas[this.currentid].style.borderWidth="1px";this.areas[this.currentid].style.borderStyle="dotted";this.areas[this.currentid].style.borderColor=this.config.CL_DRAW_BOX;}
this.areas[this.currentid].style.width=0;this.areas[this.currentid].style.height=0;this.areas[this.currentid].xpoints=[];this.areas[this.currentid].ypoints=[];this.areas[this.currentid].xpoints[0]=x;this.areas[this.currentid].ypoints[0]=y;}else{if(this.areas[this.currentid].shape=="rect"){this.is_drawing=this.DM_RECTANGLE_DRAW;this.statusMessage(this.strings.RECTANGLE_DRAW);this.areas[this.currentid].style.left=x+"px";this.areas[this.currentid].style.top=y+"px";this.areas[this.currentid].style.borderWidth="1px";this.areas[this.currentid].style.borderStyle="dotted";this.areas[this.currentid].style.borderColor=this.config.CL_DRAW_SHAPE;this.areas[this.currentid].style.width=0;this.areas[this.currentid].style.height=0;}else{if(this.areas[this.currentid].shape=="circle"){this.is_drawing=this.DM_SQUARE_DRAW;this.statusMessage(this.strings.SQUARE_DRAW);this.areas[this.currentid].style.left=x+"px";this.areas[this.currentid].style.top=y+"px";if(this.config.bounding_box){this.areas[this.currentid].style.borderWidth="1px";this.areas[this.currentid].style.borderStyle="dotted";this.areas[this.currentid].style.borderColor=this.config.CL_DRAW_BOX;}
this.areas[this.currentid].style.width=0;this.areas[this.currentid].style.height=0;}}}
this.memory[this.currentid].downx=x;this.memory[this.currentid].downy=y;};imgmap.prototype.highlightArea=function(id,_a4){if(this.is_drawing){return;}
if(this.areas[id]&&this.areas[id].shape!="undefined"){this.fireEvent("onFocusArea",this.areas[id]);if(this.areas[id].shape=="rect"){this.areas[id].style.borderWidth="1px";this.areas[id].style.borderStyle="solid";this.areas[id].style.borderColor=this.config.CL_HIGHLIGHT_SHAPE;}else{if(this.areas[id].shape=="circle"||this.areas[id].shape=="poly"){if(this.config.bounding_box){this.areas[id].style.borderWidth="1px";this.areas[id].style.borderStyle="solid";this.areas[id].style.borderColor=this.config.CL_HIGHLIGHT_BOX;}}}
var _a5=this.config.highlight_opacity;if(_a4=="grad"){_a5="-"+_a5;}
this._setopacity(this.areas[id],this.config.CL_HIGHLIGHT_BG,_a5);this._repaint(this.areas[id],this.config.CL_HIGHLIGHT_SHAPE);}};imgmap.prototype.blurArea=function(id,_a7){if(this.is_drawing){return;}
if(this.areas[id]&&this.areas[id].shape!="undefined"){this.fireEvent("onBlurArea",this.areas[id]);if(this.areas[id].shape=="rect"){this.areas[id].style.borderWidth="1px";this.areas[id].style.borderStyle="solid";this.areas[id].style.borderColor=this.config.CL_NORM_SHAPE;}else{if(this.areas[id].shape=="circle"||this.areas[id].shape=="poly"){if(this.config.bounding_box){this.areas[id].style.borderWidth="1px";this.areas[id].style.borderStyle="solid";this.areas[id].style.borderColor=this.config.CL_NORM_BOX;}}}
var _a8=this.config.norm_opacity;if(_a7=="grad"){_a8="-"+_a8;}
this._setopacity(this.areas[id],this.config.CL_NORM_BG,_a8);this._repaint(this.areas[id],this.config.CL_NORM_SHAPE);}};imgmap.prototype.area_mousemove=function(e){if(this.viewmode===1){return;}
if(!this.is_drawing){var obj=(this.isMSIE)?window.event.srcElement:e.currentTarget;if(obj.tagName=="DIV"){obj=obj.parentNode;}
if(obj.tagName=="image"||obj.tagName=="group"||obj.tagName=="shape"||obj.tagName=="stroke"){obj=obj.parentNode.parentNode;}
if(this.isOpera){e.layerX=e.offsetX;e.layerY=e.offsetY;}
var _ab=(this.isMSIE)?(window.event.offsetX):(e.layerX);var _ac=(this.isMSIE)?(window.event.offsetY):(e.layerY);if(_ab<6&&_ac>6){if(obj.shape!="poly"){obj.style.cursor="w-resize";}}else{if(_ab>parseInt(obj.style.width,10)-6&&_ac>6){if(obj.shape!="poly"){obj.style.cursor="e-resize";}}else{if(_ab>6&&_ac<6){if(obj.shape!="poly"){obj.style.cursor="n-resize";}}else{if(_ac>parseInt(obj.style.height,10)-6&&_ab>6){if(obj.shape!="poly"){obj.style.cursor="s-resize";}}else{obj.style.cursor="move";}}}}
if(obj.aid!=this.draggedId){if(obj.style.cursor=="move"){obj.style.cursor="default";}
return;}
if(_ab<6&&_ac>6){if(this.areas[this.currentid].shape=="circle"){this.is_drawing=this.DM_SQUARE_RESIZE_LEFT;this.statusMessage(this.strings.SQUARE_RESIZE_LEFT);if(this.config.bounding_box){this.areas[this.currentid].style.borderColor=this.config.CL_DRAW_BOX;}}else{if(this.areas[this.currentid].shape=="rect"){this.is_drawing=this.DM_RECTANGLE_RESIZE_LEFT;this.statusMessage(this.strings.RECTANGLE_RESIZE_LEFT);this.areas[this.currentid].style.borderColor=this.config.CL_DRAW_SHAPE;}}}else{if(_ab>parseInt(this.areas[this.currentid].style.width,10)-6&&_ac>6){if(this.areas[this.currentid].shape=="circle"){this.is_drawing=this.DM_SQUARE_RESIZE_RIGHT;this.statusMessage(this.strings.SQUARE_RESIZE_RIGHT);if(this.config.bounding_box){this.areas[this.currentid].style.borderColor=this.config.CL_DRAW_BOX;}}else{if(this.areas[this.currentid].shape=="rect"){this.is_drawing=this.DM_RECTANGLE_RESIZE_RIGHT;this.statusMessage(this.strings.RECTANGLE_RESIZE_RIGHT);this.areas[this.currentid].style.borderColor=this.config.CL_DRAW_SHAPE;}}}else{if(_ab>6&&_ac<6){if(this.areas[this.currentid].shape=="circle"){this.is_drawing=this.DM_SQUARE_RESIZE_TOP;this.statusMessage(this.strings.SQUARE_RESIZE_TOP);if(this.config.bounding_box){this.areas[this.currentid].style.borderColor=this.config.CL_DRAW_BOX;}}else{if(this.areas[this.currentid].shape=="rect"){this.is_drawing=this.DM_RECTANGLE_RESIZE_TOP;this.statusMessage(this.strings.RECTANGLE_RESIZE_TOP);this.areas[this.currentid].style.borderColor=this.config.CL_DRAW_SHAPE;}}}else{if(_ac>parseInt(this.areas[this.currentid].style.height,10)-6&&_ab>6){if(this.areas[this.currentid].shape=="circle"){this.is_drawing=this.DM_SQUARE_RESIZE_BOTTOM;this.statusMessage(this.strings.SQUARE_RESIZE_BOTTOM);if(this.config.bounding_box){this.areas[this.currentid].style.borderColor=this.config.CL_DRAW_BOX;}}else{if(this.areas[this.currentid].shape=="rect"){this.is_drawing=this.DM_RECTANGLE_RESIZE_BOTTOM;this.statusMessage(this.strings.RECTANGLE_RESIZE_BOTTOM);this.areas[this.currentid].style.borderColor=this.config.CL_DRAW_SHAPE;}}}else{if(this.areas[this.currentid].shape=="circle"){this.is_drawing=this.DM_SQUARE_MOVE;this.statusMessage(this.strings.SQUARE_MOVE);if(this.config.bounding_box){this.areas[this.currentid].style.borderColor=this.config.CL_DRAW_BOX;}
this.memory[this.currentid].rdownx=_ab;this.memory[this.currentid].rdowny=_ac;}else{if(this.areas[this.currentid].shape=="rect"){this.is_drawing=this.DM_RECTANGLE_MOVE;this.statusMessage(this.strings.RECTANGLE_MOVE);this.areas[this.currentid].style.borderColor=this.config.CL_DRAW_SHAPE;this.memory[this.currentid].rdownx=_ab;this.memory[this.currentid].rdowny=_ac;}else{if(this.areas[this.currentid].shape=="poly"){if(this.areas[this.currentid].xpoints){for(var i=0;i<this.areas[this.currentid].xpoints.length;i++){this.memory[this.currentid].xpoints[i]=this.areas[this.currentid].xpoints[i];this.memory[this.currentid].ypoints[i]=this.areas[this.currentid].ypoints[i];}}
this.is_drawing=this.DM_POLYGON_MOVE;this.statusMessage(this.strings.POLYGON_MOVE);if(this.config.bounding_box){this.areas[this.currentid].style.borderColor=this.config.CL_DRAW_BOX;}
this.memory[this.currentid].rdownx=_ab;this.memory[this.currentid].rdowny=_ac;}}}}}}}
this.memory[this.currentid].width=parseInt(this.areas[this.currentid].style.width,10);this.memory[this.currentid].height=parseInt(this.areas[this.currentid].style.height,10);this.memory[this.currentid].top=parseInt(this.areas[this.currentid].style.top,10);this.memory[this.currentid].left=parseInt(this.areas[this.currentid].style.left,10);if(this.areas[this.currentid].shape=="rect"){this.areas[this.currentid].style.borderWidth="1px";this.areas[this.currentid].style.borderStyle="dotted";}else{if(this.areas[this.currentid].shape=="circle"||this.areas[this.currentid].shape=="poly"){if(this.config.bounding_box){this.areas[this.currentid].style.borderWidth="1px";this.areas[this.currentid].style.borderStyle="dotted";}}}
this._setopacity(this.areas[this.currentid],this.config.CL_DRAW_BG,this.config.draw_opacity);}else{this.img_mousemove(e);}};imgmap.prototype.area_mouseup=function(e){if(this.viewmode===1){return;}
if(!this.is_drawing){var obj=(this.isMSIE)?window.event.srcElement:e.currentTarget;if(obj.tagName=="DIV"){obj=obj.parentNode;}
if(obj.tagName=="image"||obj.tagName=="group"||obj.tagName=="shape"||obj.tagName=="stroke"){obj=obj.parentNode.parentNode;}
if(this.areas[this.currentid]!=obj){if(typeof obj.aid=="undefined"){this.log("Cannot identify target area",1);return;}}
this.draggedId=null;}else{this.img_mouseup(e);}};imgmap.prototype.area_mouseover=function(e){if(this.viewmode===1&&this.config.mode!==""){return;}
if(!this.is_drawing){var obj=(this.isMSIE)?window.event.srcElement:e.currentTarget;if(obj.tagName=="DIV"){obj=obj.parentNode;}
if(obj.tagName=="image"||obj.tagName=="group"||obj.tagName=="shape"||obj.tagName=="stroke"){obj=obj.parentNode.parentNode;}
this.highlightArea(obj.aid,"grad");}};imgmap.prototype.area_mouseout=function(e){if(this.viewmode===1&&this.config.mode!==""){return;}
if(!this.is_drawing){var obj=(this.isMSIE)?window.event.srcElement:e.currentTarget;if(obj.tagName=="DIV"){obj=obj.parentNode;}
if(obj.tagName=="image"||obj.tagName=="group"||obj.tagName=="shape"||obj.tagName=="stroke"){obj=obj.parentNode.parentNode;}
this.blurArea(obj.aid,"grad");}};imgmap.prototype.area_mousedown=function(e){if(this.viewmode===1){return;}
if(!this.is_drawing){var obj=(this.isMSIE)?window.event.srcElement:e.currentTarget;if(obj.tagName=="DIV"){obj=obj.parentNode;}
if(obj.tagName=="image"||obj.tagName=="group"||obj.tagName=="shape"||obj.tagName=="stroke"){obj=obj.parentNode.parentNode;}
if(this.areas[this.currentid]!=obj){if(typeof obj.aid=="undefined"){this.log("Cannot identify target area",1);return;}
this.currentid=obj.aid;}
this.draggedId=this.currentid;this.selectedId=this.currentid;this.fireEvent("onSelectArea",this.areas[this.currentid]);if(this.isMSIE){window.event.cancelBubble=true;}else{e.stopPropagation();}}else{this.img_mousedown(e);}};imgmap.prototype.doc_keydown=function(e){if(this.viewmode===1){return;}
var key=(this.isMSIE)?event.keyCode:e.keyCode;if(key==46){if(this.selectedId!==null&&!this.is_drawing){this.removeArea(this.selectedId);}}else{if(key==16){if(this.is_drawing==this.DM_RECTANGLE_DRAW){this.is_drawing=this.DM_SQUARE_DRAW;this.statusMessage(this.strings.SQUARE2_DRAW);}}}};imgmap.prototype.doc_keyup=function(e){var key=(this.isMSIE)?event.keyCode:e.keyCode;if(key==16){if(this.is_drawing==this.DM_SQUARE_DRAW&&this.areas[this.currentid].shape=="rect"){this.is_drawing=this.DM_RECTANGLE_DRAW;this.statusMessage(this.strings.RECTANGLE_DRAW);}}};imgmap.prototype.doc_mousedown=function(e){if(this.viewmode===1){return;}
if(!this.is_drawing){this.selectedId=null;}};imgmap.prototype._getPos=function(_bb){var _bc=0;var _bd=0;if(_bb){var _be=_bb.offsetParent;if(_be){while((_be=_bb.offsetParent)){_bc+=_bb.offsetLeft;_bd+=_bb.offsetTop;_bb=_be;}}else{_bc=_bb.offsetLeft;_bd=_bb.offsetTop;}}
return{x:_bc,y:_bd};};imgmap.prototype._getLastArea=function(){for(var i=this.areas.length-1;i>=0;i--){if(this.areas[i]){return this.areas[i];}}
return null;};imgmap.prototype.toClipBoard=function(_c0){this.fireEvent("onClipboard",_c0);if(typeof _c0=="undefined"){_c0=this.getMapHTML();}
try{if(window.clipboardData){window.clipboardData.setData("Text",_c0);}else{if(window.netscape){netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var str=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);if(!str){return false;}
str.data=_c0;var _c2=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!_c2){return false;}
_c2.addDataFlavor("text/unicode");_c2.setTransferData("text/unicode",str,_c0.length*2);var _c3=Components.interfaces.nsIClipboard;var _c4=Components.classes["@mozilla.org/widget/clipboard;1"].getService(_c3);if(!_c4){return false;}
_c4.setData(_c2,null,_c3.kGlobalClipboard);}else{if(typeof air=="object"){air.Clipboard.generalClipboard.clear();air.Clipboard.generalClipboard.setData("air:text",_c0,false);}}}}
catch(err){this.log("Unable to set clipboard data",1);}};imgmap.prototype.assignCSS=function(obj,_c6){var _c7=_c6.split(";");for(var i=0;i<_c7.length;i++){var p=_c7[i].split(":");var pp=p[0].trim().split("-");var _cb=pp[0];for(var j=1;j<pp.length;j++){_cb+=pp[j].replace(/^./,pp[j].substring(0,1).toUpperCase());}
obj.style[_cb.trim()]=p[1].trim();}};imgmap.prototype.fireEvent=function(evt,obj){if(typeof this.config.custom_callbacks[evt]=="function"){return this.config.custom_callbacks[evt](obj);}};imgmap.prototype.setAreaSize=function(id,w,h){if(!id){id=this.currentid;}
if(w!==null){this.areas[id].width=w;this.areas[id].style.width=(w)+"px";this.areas[id].setAttribute("width",w);}
if(h!==null){this.areas[id].height=h;this.areas[id].style.height=(h)+"px";this.areas[id].setAttribute("height",h);}};imgmap.prototype.detectLanguage=function(){var _d2;if(navigator.userLanguage){_d2=navigator.userLanguage.toLowerCase();}else{if(navigator.language){_d2=navigator.language.toLowerCase();}else{return this.config.defaultLang;}}
if(_d2.length>=2){_d2=_d2.substring(0,2);return _d2;}
return this.config.defaultLang;};imgmap.prototype.disableSelection=function(_d3){if(typeof _d3=="undefined"||!_d3){return false;}
if(typeof _d3.onselectstart!="undefined"){_d3.onselectstart=function(){return false;};}
if(typeof _d3.unselectable!="undefined"){_d3.unselectable="on";}
if(typeof _d3.style.MozUserSelect!="undefined"){_d3.style.MozUserSelect="none";}};Function.prototype.bind=function(_d4){var _d5=this;return function(){return _d5.apply(_d4,arguments);};};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"");};String.prototype.ltrim=function(){return this.replace(/^\s+/,"");};String.prototype.rtrim=function(){return this.replace(/\s+$/,"");};function imgmap_spawnObjects(_d6){var _d7=document.getElementsByTagName("map");var _d8=document.getElementsByTagName("img");var _d9=[];for(var i=0;i<_d7.length;i++){for(var j=0;j<_d8.length;j++){if("#"+_d7[i].name==_d8[j].getAttribute("usemap")){_d6.mode="";imapn=new imgmap(_d6);imapn.useImage(_d8[j]);imapn.setMapHTML(_d7[i]);imapn.viewmode=1;_d9.push(imapn);}}}}