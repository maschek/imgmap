<html>
<head>
<title>Online Image Map Editor - Example 5</title>
<link rel="stylesheet" href="example1_files/imgmap.css" type="text/css">
<!--[if gte IE 6]>
<script language="javascript" type="text/javascript" src="../excanvas.js"></script>
<![endif]-->
</head>
<body>
<p style="font-size: 12px; font-weight: bold">
Example 5 shows how to register custom callback functions on imgmap events. Try to click on the href input field of any area, to get an example why is it useful. (Not working in Firefox yet)
</p>
	<form id="img_area_form">
		<fieldset>
			<legend>
				<a onclick="toggleFieldset(this.parentNode.parentNode)">Select source</a>
			</legend>
			<div>
				<div class="source_desc">An image on your computer:</div>
				<div class="source_url">
					<iframe id="iframe_uploader"
						name="uploader"
						src="example1_files/upload.php"
						scrolling="no"
						noresize="noresize"
						frameborder="no"
						width="240"
						height="24"></iframe>
				</div>
				<a href="javascript:myimgmap.loadImage(window.frames['uploader'].document.getElementById('src').getAttribute('rel'))" class="source_accept">accept</a><br/>
				
				<div class="source_desc">An image on the Internet:</div>
				<div class="source_url"><input type="txt" id="source_url2" value="http://"></div>
				<a href="javascript:myimgmap.loadImage(document.getElementById('source_url2').value)" class="source_accept">accept</a><br/>
				
				<div class="source_desc">Use a sample image:</div>
				<div class="source_url">
					<select id="source_url3">
						<option value="example_files/sample1.jpg" >sample 1</option>
						<option value="example_files/sample2.jpg" >sample 2</option>
						<option value="example_files/sample3.jpg" >sample 3</option>
						<option value="example_files/sample4.jpg" >sample 4</option>
					</select>
				</div>
				<a href="javascript:myimgmap.loadImage(document.getElementById('source_url3').value)" class="source_accept">accept</a><br/>
			</div>
		</fieldset>
		<fieldset>
			<legend>
				<a onclick="toggleFieldset(this.parentNode.parentNode)">Image map areas</a>
			</legend>
			<div style="border-bottom: solid 1px #efefef">
			<div id="button_container" style="float: left;">
			<!-- buttons come here -->
			</div>
			<div style="float: right; margin: 0 5px">
				<select onchange="changelabeling(this)">
				<option value=''>No labeling</option>
				<option value='%n' selected='1'>Label with numbers</option>
				<option value='%a'>Label with alt text</option>
				<option value='%h'>Label with href</option>
				<option value='%c'>Label with coords</option>
				</select>
			</div>
			<div style="float: right; margin: 0 5px">
				<input type="checkbox" onClick="toggleBoundingBox(this)"/>
				bounding box
			</div>
			</div>
			<div id="form_container" style="clear: both;">
			<!-- form elements come here -->
         	</div>
		</fieldset>
		<fieldset>
			<legend>
				<a onclick="toggleFieldset(this.parentNode.parentNode)">Image</a>
			</legend>
			<div id="pic_container">
			</div>			
		</fieldset>
		<fieldset>
			<legend>
				<a onclick="toggleFieldset(this.parentNode.parentNode)">Status</a>
			</legend>
			<div id="status_container"></div>
		</fieldset>
		<fieldset id="fieldset_html" class="fieldset_off">
			<legend>
				<a onclick="toggleFieldset(this.parentNode.parentNode)">Code</a>
			</legend>
			<div>
			<img src="example1_files/clipboard.gif" onclick="myimgmap.toClipBoard()" style="float: right; margin: 5px; cursor: pointer;"/>
			This is the generated image map HTML code.
			Click into the textarea below and press Ctrl+C to copy the code to your clipboard. Alternatively you can use the
			clipboard icon on the right. Please note, that you have to attach this code to your image, via the usemap property
			(<a href="http://www.htmlhelp.com/reference/html40/special/map.html">read more</a>). 
			
			<textarea id="html_container"></textarea></div>
		</fieldset>
		<fieldset id="fieldset_log">
			<legend>
				<a onclick="toggleFieldset(this.parentNode.parentNode)">Events</a>
			</legend>
			<div>
			Events of the imgmap editor:<br/>
			<textarea id="log_container" style="width: 100%; height: 150px;"></textarea></div>
		</fieldset>
	</form>

<script type="text/javascript" src="../imgmap.js?nocache=ex5"></script>
<script type="text/javascript">
//instantiate the imgmap component, setting up some basic config values
var myimgmap = new imgmap({
mode : "editor",
button_container: document.getElementById('button_container'),
imgroot: 'example1_files/',
buttons : ['add','delete','preview','html','clipboard'],
custom_callbacks : {
	'onPreview' : function(){mylog('onPreview');},
	'onClipboard' : function(){mylog('onClipboard');},
	'onHtml' : function(){mylog('onHtml');htmlShow();},
	'onAddArea' : function(){mylog('onAddArea');},
	'onRemoveArea' : function(){mylog('onRemoveArea');},
	'onDrawArea' : function(){mylog('onDrawArea');},
	'onResizeArea' : function(){mylog('onResizeArea');},
	'onRelaxArea' : function(){mylog('onRelaxArea');},
	'onFocusArea' : function(){mylog('onFocusArea');},
	'onBlurArea' : function(){mylog('onBlurArea');},
	'onMoveArea' : function(){mylog('onMoveArea');},
	'onSelectRow' : function(obj){
		mylog('onSelectRow');
		onSelectRow(obj);
		},
	'onLoadImage' : function(){mylog('onLoadImage');alert('image loaded');},
	'onSetMap' : function(){mylog('onSetMap');},
	'onGetMap' : function(){mylog('onGetMap');}
},
pic_container: document.getElementById('pic_container'),
html_container: document.getElementById('html_container'),
status_container: document.getElementById('status_container'),
form_container: document.getElementById('form_container'),
bounding_box : true
});

function mylog(msg) {
	document.getElementById('log_container').innerHTML+= msg + "\n";
}

function htmlShow() {
	toggleFieldset(document.getElementById('fieldset_html'), 1);
	document.getElementById('html_container').focus();
}

function changelabeling(obj) {
	myimgmap.config.label = obj.value;
	myimgmap._repaintAll();
}

function toggleBoundingBox(obj) {
	//console.log(obj.checked);
	myimgmap.config.bounding_box = obj.checked;
	myimgmap.relaxAllAreas();
}

/**
 *	Toggles fieldset visibility by changing the className.
 *	@date	2006.10.24. 22:13:34
 *	@author	Adam Maschek (maschek@freemail.hu)
 */
function toggleFieldset(fieldset, on) {
	if (fieldset) {
		if (fieldset.className == 'fieldset_off' || on == 1) {
			fieldset.className = '';
		}
		else {
			fieldset.className = 'fieldset_off';
		}
	}
}

function onSelectRow(obj) {
	//not yet in FFX :S
	if (window.event) {
		var obj = window.event.srcElement;
	}
	if (typeof obj != 'undefined')
	if (obj.name == 'img_href') {
		window.open('example5_files/url.html');
		targetObj = obj;
	}
}

</script>
</body>
</html>
